/*! ARCS 2016-12-05 */
var ARCS=ARCS||{};if(ARCS.isInNode=function(){return"function"==typeof require&&require.resolve},ARCS.isInRequire=function(){return"function"==typeof define&&define.amd},ARCS.Component={SourceIsNotComponent:{message:"Source is not a component"},UndefinedSignal:{message:"Signal is not defined"},UndefinedSlot:{message:"Slot is not defined"},create:function(a,b,c){return void 0===a.prototype?(console.error("Cannot create such a component"),0):(a.prototype.slots=[],a.prototype.signals={},a.slotList=function(){return a.prototype.slots},a.prototype.slotList=function(){return a.prototype.slots},a.prototype.signalList=function(){var b,c=[];for(b in a.prototype.signals)c.push(b);return c},a.signalList=function(){return a.prototype.signalList()},a.prototype.emit=function(a){var b,c,d,e=Array.prototype.slice.call(arguments,1);for(b in this.signals[a])c=this.signals[a][b].func,d=this.signals[a][b].obj,c.apply(d,e)},a.slot=function(b,c){var d;if(b instanceof Array)for(d=0;d<b.length;d++)a.prototype.slots.push(b[d]);else a.prototype.slots.push(b),void 0!==c&&(a.prototype[b]=c)},a.signal=function(b){var c;if(b instanceof Array)for(c=0;c<b.length;c++)a.prototype.signals[b[c]]=1;else a.prototype.signals[b]=1},void 0!==b&&a.slot(b),void 0!==c&&a.signal(c),a)},check:function(a){return void 0!==a.prototype&&(void 0!==a.prototype.signals&&void 0!==a.prototype.slots)},connect:function(a,b,c,d){var e,f;if(void 0===a.signals)throw ARCS.Component.SourceIsNotComponent;if(void 0===a.signals[b])throw ARCS.Component.UndefinedSignal;if(void 0===c[d])throw ARCS.Component.UndefinedSlot;if(!a.hasOwnProperty("signals")){e=a.signals,a.signals={};for(f in e)a.signals[f]=[]}a.signals[b].push({obj:c,func:c[d]})},disconnect:function(a,b,c,d){var e;for(e=0;e<a.signals[b].length;e++)a.signals[b][e].obj===c&&a.signals[b][e].func===c[d]&&(a.signals[b].splice(e,1),e--)},invoke:function(a,b,c){if(void 0===a[b])throw ARCS.Component.UndefinedSlot;var d=a[b];d.apply(a,c)},config:function(a,b){"function"==typeof a.config&&a.config(b)}},ARCS.Context=function(a){var b,c,d,e,f={},g={},h={},j=[],k=[],l=this;if(h.StateMachine=ARCS.Statemachine,void 0!==a){j=a.libraries;for(p in a.components)a.components.hasOwnProperty(p)&&(f[p]=a.components[p]);if(void 0!==a.constants)for(p in a.constants)a.constants.hasOwnProperty(p)&&(g[p]=a.constants[p])}c=function(a){return ARCS.isInNode()?new Promise(function(b,c){var d=require(a);void 0!==d?b(d):c("[ARCS] File not found")}):new Promise(function(b,c){var d=new XMLHttpRequest;d.open("GET",a,!0),d.overrideMimeType("application/json"),d.send(),d.onload=function(){this.status>=200&&this.status<300?b(JSON.parse(this.responseText)):c(this.statusText)},d.onerror=function(){c(this.statusText)}})},this.addLibraryPromise=function(a){k.push(a)},d=function(a){return new Promise(function(b,c){".js"===a.substr(-3)&&c(a),ARCS.isInNode()?void 0===require("./"+j[i]+".js")?c(a):b():require([a],function(){b()},function(b){c(a,b)})})},b=function(){var a;ARCS.Context.currentContext=l;var b=[];for(a=0;a<j.length;a++)b.push(d(j[a]));return Promise.all(b)},e=function(){var a,b=[];for(a in f)if(f.hasOwnProperty(a)){if(void 0===h[f[a].type])return console.error("[ARCS] Factory "+f[a].type+" not found."),void console.error("[ARCS] Context dump follows: ",j,f,g);factory=h[f[a].type];try{void 0!==f[a].value||void 0!==f[a].url||void 0!==f[a].ref?(void 0!==f[a].value&&(console.log("instanciating ",a),f[a].instance=new factory(f[a].value)),void 0!==f[a].url&&b.push(c(f[a].url).then(function(b){f[a].instance=new factory(b)})),void 0!==f[a].ref&&void 0!==g[f[a].ref]&&(f[a].instance=new factory(g[f[a].ref]))):f[a].instance=new factory}catch(b){console.error("[ARCS] Component of type ",a," not instanciated.",b)}}return Promise.all(b)},this.loadLibrary=function(a,b){var c=a,e=a;ARCS.Context.currentContext=l,"string"!=typeof a&&(e=a.name,c=a.url),j.push(e),d(c).then(function(){void 0!==b&&b()})},this.getComponentList=function(){var a,b=Object.keys(f);for(a=0;a<b.length;a++)f.hasOwnProperty(b[a])||b.splice(a--,1);return b},this.getConstant=function(a){return g[a]},this.getComponentType=function(a){if(void 0!==f[a])return f[a].type},this.getComponentValue=function(a){if(void 0!==f[a])return f[a].value},this.getComponent=function(a){if(void 0!==f[a])return f[a].instance},this.getComponentName=function(a){var b,c;for(c=f.getComponentList(),b=0;b<c.length;b++)if(f[c[b]].instance===a)return c[b]},this.setFactory=function(a,b){h[a]=b},this.toJSON=function(){var a,b={};for(a in f)f.hasOwnProperty(a)&&(b[a]={type:f[a].type,value:f[a].value});return b},this.setComponentValue=function(a,b){f[a].value=b},this.addComponent=function(a,b,c){var d;f[a]={},f[a].type=b,f[a].value=c;var e=h[b];void 0!==e&&(d=new e(c)),f[a].instance=d},this.removeComponent=function(a){delete f[a]},this.getFactory=function(a){return h[a]},this.getFactoryList=function(){return Object.keys(h)},this.instanciate=function(){return b().then(function(){return Promise.all(k)}).then(e).catch(function(a){console.log("[ARCS] Trouble instanciating context"+a)})};var m=function(a,b){var c,d=Object.create(b);for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);return d};this.chain=function(a,b,c){return[m(a,f),m(b,g),m(c,h)]},this.setParent=function(a){if(void 0!==a){var b=a.chain(f,g,h);f=b[0],g=b[1],h=b[2]}}},ARCS.Context.currentContext=null,ARCS.Invocation=function(a,b,c){this.getDestination=function(){return a},this.getSlot=function(){return b},this.getValue=function(){return c},this.invoke=function(){var d=a[b];return void 0===d?void console.error("Undefined slot %s of component %s",b,a):void d.apply(a,c)}},ARCS.Invocation.cast=function(a,b){if(void 0!==a.value){var c=b.getComponent(a.destination);return void 0===c&&console.error("[ARCS] Destination ",a.destination," is undefined"),new ARCS.Invocation(c,a.slot,a.value)}if(void 0!==a.ref)return new ARCS.Invocation(b.getComponent(a.destination),a.slot,b.getConstant(a.ref))},ARCS.Invocation.PRE_CONNECTION=0,ARCS.Invocation.POST_CONNECTION=1,ARCS.Invocation.CLEAN_UP=2,ARCS.Connection=function(a,b,c,d){this.connect=function(){try{ARCS.Component.connect(a,b,c,d)}catch(e){console.log(e,a,b,c,d)}},this.disconnect=function(){ARCS.Component.disconnect(a,b,c,d)},this.getSource=function(){return a},this.getDestination=function(){return c},this.getSlot=function(){return d},this.getSignal=function(){return b}},ARCS.Connection.cast=function(a,b){return new ARCS.Connection(b.getComponent(a.source),a.signal,b.getComponent(a.destination),a.slot)},ARCS.Sheet=function(a){var b,c,d,e,f,g=new ARCS.Context,h=[],i=[],j=[],k=[],l=0,m=0,n=0,o=0;b=function(){var a;for(a=0;a<h.length;a++)h[a].invoke()},c=function(){var a;for(a=0;a<i.length;a++)i[a].invoke()},d=function(){var a;for(a=0;a<j.length;a++)j[a].invoke()},e=function(){var a;for(a=0;a<k.length;a++)k[a].connect()},f=function(){var a;for(a=0;a<k.length;a++)k[a].disconnect()},this.setContext=function(a){g=a},this.activate=function(){g.instanciate().then(function(){b(),e(),c()})},this.deactivate=function(){f(),d()},this.addPreConnection=function(a){var b=ARCS.Invocation.cast(a,g);return b.id=l++,h.push(b),b.id},this.addPostConnection=function(a){var b=ARCS.Invocation.cast(a,g);return b.id=m++,i.push(b),b.id},this.addCleanup=function(a){var b=ARCS.Invocation.cast(a,g);return b.id=n++,j.push(b),b.id},this.addConnection=function(a){var b=ARCS.Connection.cast(a,g);return b.id=o++,k.push(b),b.id};var p=function(a,b){for(var c=b.length;c--&&b[c].id!==a;);c>=0?b.splice(c,1):console.warn("Could not remove data with id",a)};this.removePreConnection=function(a){p(a,h)},this.removePostConnection=function(a){p(a,i)},this.removeCleanup=function(a){p(a,j)};var q=function(a,b,c){for(var d=c.length;d--&&c[d].id!==a;);d>=0&&(c[d].value=b)};this.changePreConnection=function(a,b){q(a,b,h)},this.changePostConnection=function(a,b){q(a,b,i)},this.changeCleanup=function(a,b){q(a,b,j)},this.removeConnection=function(a){p(a,k)};var r=function(a,b,c){for(var d,e=c.length,f=c.length;e--&&c[e].id!==a;);for(;f--&&c[f].id!==b;);e>=0&&f>=0&&(d=c[e],c[e]=c[f],c[f]=d,c[e].id=a,c[f].id=b)};this.swapConnections=function(a,b){r(a,b,k)},this.swapCleanups=function(a,b){r(a,b,j)},this.swapPreConnections=function(a,b){r(a,b,h)},this.swapPostConnections=function(a,b){r(a,b,i)};var s=function(a){var b=0,c=ARCS.Invocation.cast,d=ARCS.Connection.cast;for(b=0;b<a.preconnections.length;b++)h.push(c(a.preconnections[b],g));for(b=0;b<a.postconnections.length;b++)i.push(c(a.postconnections[b],g));for(b=0;b<a.cleanups.length;b++)j.push(c(a.cleanups[b],g));for(b=0;b<a.connections.length;b++)k.push(d(a.connections[b],g))};this.import=function(b){b.hasOwnProperty("context")&&(g=new ARCS.Context(b.context),g.setParent(a)),g.instanciate().then(function(){s(b)})};var t=function(a){return{destination:g.getComponentName(a.getDestination()),slot:a.getSlot(),value:a.getValue()}},u=function(a){return{source:g.getComponentName(a.getSource()),signal:a.getSignal(),destination:g.getComponentName(a.getDestination()),slot:a.getSlot()}};this.toJSON=function(){var a,b=[],c=[],d=[],e=[];for(a=0;a<k.length;a++)d.push(u(k[a]));for(a=0;a<h.length;a++)b.push(t(h[a]));for(a=0;a<i.length;a++)c.push(t(i[a]));for(a=0;a<j.length;a++)e.push(t(j[a]));return{preconnections:b,postconnections:c,connections:d,cleanups:e}},g.setParent(a)},ARCS.EventLogicParser=function(){function a(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c}function b(a,b,c,d,e,f){this.message=a,this.expected=b,this.found=c,this.offset=d,this.line=e,this.column=f,this.name="SyntaxError"}function c(a){function c(b){function c(b,c,d){var e,f;for(e=c;e<d;e++)f=a.charAt(e),"\n"===f?(b.seenCR||b.line++,b.column=1,b.seenCR=!1):"\r"===f||"\u2028"===f||"\u2029"===f?(b.line++,b.column=1,b.seenCR=!0):(b.column++,b.seenCR=!1)}return R!==b&&(R>b&&(R=0,S={line:1,column:1,seenCR:!1}),c(S,R,b),R=b),S}function d(a){P<T||(P>T&&(T=P,U=[]),U.push(a))}function e(d,e,f){function g(a){var b=1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function h(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0180-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1080-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d,e,f,g=new Array(a.length);for(f=0;f<a.length;f++)g[f]=a[f].description;return d=a.length>1?g.slice(0,-1).join(", ")+" or "+g[a.length-1]:g[0],e=b?'"'+c(b)+'"':"end of input","Expected "+d+" but "+e+" found."}var i=c(f),j=f<a.length?a.charAt(f):null;return null!==e&&g(e),new b(null!==d?d:h(e,j),e,j,f,i.line,i.column)}function f(){var a;return a=g()}function g(){var a,b,c,d;if(a=P,b=i(),b!==q){if(c=[],d=h(),d!==q)for(;d!==q;)c.push(d),d=h();else c=t;c!==q?(Q=a,b=u(b,c),a=b):(P=a,a=t)}else P=a,a=t;return a===q&&(a=i()),a}function h(){var a,b,c;return a=P,b=l(),b!==q?(c=i(),c!==q?(Q=a,b=v(c),a=b):(P=a,a=t)):(P=a,a=t),a===q&&(a=P,b=m(),b!==q?(c=i(),c!==q?(Q=a,b=w(c),a=b):(P=a,a=t)):(P=a,a=t)),a}function i(){var b,c,e,f;return b=P,c=j(),c!==q&&(Q=b,c=x(c)),b=c,b===q&&(b=P,40===a.charCodeAt(P)?(c=y,P++):(c=q,0===V&&d(z)),c!==q?(e=g(),e!==q?(41===a.charCodeAt(P)?(f=A,P++):(f=q,0===V&&d(B)),f!==q?(Q=b,c=C(e),b=c):(P=b,b=t)):(P=b,b=t)):(P=b,b=t)),b}function j(){var b,c,e;return V++,b=P,c=P,e=k(),e!==q&&(e=a.substring(c,P)),c=e,c!==q&&(Q=b,c=E(c)),b=c,V--,b===q&&(c=q,0===V&&d(D)),b}function k(){var b,c,e,f,g;if(b=P,c=n(),c!==q)if(F.test(a.charAt(P))?(e=a.charAt(P),P++):(e=q,0===V&&d(G)),e!==q){for(f=[],H.test(a.charAt(P))?(g=a.charAt(P),P++):(g=q,0===V&&d(I));g!==q;)f.push(g),H.test(a.charAt(P))?(g=a.charAt(P),P++):(g=q,0===V&&d(I));f!==q?(g=n(),g!==q?(c=[c,e,f,g],b=c):(P=b,b=t)):(P=b,b=t)}else P=b,b=t;else P=b,b=t;return b}function l(){var b,c,e,f;return b=P,c=n(),c!==q?(38===a.charCodeAt(P)?(e=J,P++):(e=q,0===V&&d(K)),e!==q?(f=n(),f!==q?(c=[c,e,f],b=c):(P=b,b=t)):(P=b,b=t)):(P=b,b=t),b}function m(){var b,c,e,f;return b=P,c=n(),c!==q?(124===a.charCodeAt(P)?(e=L,P++):(e=q,0===V&&d(M)),e!==q?(f=n(),f!==q?(c=[c,e,f],b=c):(P=b,b=t)):(P=b,b=t)):(P=b,b=t),b}function n(){var b,c;for(b=[],N.test(a.charAt(P))?(c=a.charAt(P),P++):(c=q,0===V&&d(O));c!==q;)b.push(c),N.test(a.charAt(P))?(c=a.charAt(P),P++):(c=q,0===V&&d(O));return b}var o,p=arguments.length>1?arguments[1]:{},q={},r={start:f},s=f,t=q,u=function(a,b){return[a].concat(b)},v=function(a){return{and:a}},w=function(a){return{or:a}},x=function(a){return a},y="(",z={type:"literal",value:"(",description:'"("'},A=")",B={type:"literal",value:")",description:'")"'},C=function(a){return[a]},D={type:"other",description:"id"},E=function(a){return a.trim()},F=/^[_a-zA-Z]/,G={type:"class",value:"[_a-zA-Z]",description:"[_a-zA-Z]"},H=/^[_a-zA-Z0-9]/,I={type:"class",value:"[_a-zA-Z0-9]",description:"[_a-zA-Z0-9]"},J="&",K={type:"literal",value:"&",description:'"&"'},L="|",M={type:"literal",value:"|",description:'"|"'},N=/^[ \r\n\t]/,O={type:"class",value:"[ \\r\\n\\t]",description:"[ \\r\\n\\t]"},P=0,Q=0,R=0,S={line:1,column:1,seenCR:!1},T=0,U=[],V=0;if("startRule"in p){if(!(p.startRule in r))throw new Error("Can't start parsing from rule \""+p.startRule+'".');s=r[p.startRule]}if(o=s(),o!==q&&P===a.length)return o;throw o!==q&&P<a.length&&d({type:"end",description:"end of input"}),e(null,U,T)}return a(b,Error),{SyntaxError:b,parse:c}}(),ARCS.TransitionSystem=function(a,b,c){this.initial="",this.final="";var d={};void 0!==a&&(void 0===b||void 0===c?(this.initial="a$",this.final="z$",d[this.initial]={},d[this.initial][a]=this.final):(this.initial=a,this.final=c,d[this.initial]={},d[this.initial][b]=this.final)),this.visitTransitions=function(a){var b,c;for(b in d)if(d.hasOwnProperty(b))for(c in d[b])d[b].hasOwnProperty(c)&&a(b,c,d[b][c])},this.clone=function(a){var b=a||"",c=new ARCS.TransitionSystem;return c.initial=b+this.initial,c.final=b+this.final,this.visitTransitions(function(a,d,e){c.addTransition(b+a,d,b+e)}),c},this.fuse=function(a,b,c){var d=a.clone();return this.visitTransitions(function(a,b,c){d.addTransition(a,b,c)}),void 0===b?d.initial=this.initial:d.initial=b,void 0===c?d.final=this.final:d.final=c,d},this.hasState=function(a){if(this.initial===a||this.final===a||d.hasOwnProperty(a))return!0;try{this.visitTransitions(function(b,c,d){if(d===a)throw"!"})}catch(a){if("!"===a)return!0}return!1},this.renameState=function(a,b){this.hasState(b)&&console.error("This transition system is corrupt !"),this.initial===a&&(this.initial=b),this.final===a&&(this.final=b),d.hasOwnProperty(a)&&(d[b]=d[a],delete d[a]),this.visitTransitions(function(c,e,f){f===a&&(d[c][e]=b)})},this.dump=function(){console.log("@ = "+this.initial+", + = "+this.final),this.visitTransitions(function(a,b,c){console.log("  "+a+"\t---\t"+b+"\t-->\t"+c)})},this.getStates=function(){var a=[];return this.visitTransitions(function(b,c,d){a.indexOf(b)<0&&a.push(b),a.indexOf(d)<0&&a.push(d)}),a},this.addTransition=function(a,b,c){d.hasOwnProperty(a)||(d[a]={}),d[a][b]=c},this.and=function(a){var b,c,d,e=this.clone("i"),f=this.clone("j"),g=e.fuse(f,e.initial,f.final),h=this.getStates();for(b=0;b<h.length;b++)c=a.clone("k"+b),c.renameState(c.initial,"i"+h[b]),c.renameState(c.final,"j"+h[b]),d=g.fuse(c),g=d;return g},this.or=function(a){var b=this.clone("s"),c=a.clone("t");return c.renameState(c.initial,b.initial),c.renameState(c.final,b.final),b.fuse(c)}},ARCS.TransitionSystem.build=function(a,b){var c,d,e,f,g=b||1,h=1;if("string"==typeof a)return new ARCS.TransitionSystem(a).clone("w0d"+g);for(d=ARCS.TransitionSystem.build(a[0],g+1),c=1;c<a.length;c++)a[c].hasOwnProperty("and")?(f=ARCS.TransitionSystem.build(a[c].and,g+1).clone("w"+h++),e=d.and(f)):a[c].hasOwnProperty("or")?(f=ARCS.TransitionSystem.build(a[c].or,g+1).clone("w"+h++),e=d.or(f)):console.warn("[ARCS] Illegal tree"),d=e;return d},ARCS.Statemachine=new ARCS.Component.create(function(a){var b="",c="",d={},e="",f=this,g=function(a){f.slots.indexOf(a)<0&&(f.slots.push(a),f[a]=function(a){return function(){f.setToken(a)}}(a))};this.setInitialState=function(a){b=a,e=b},this.setFinalState=function(a){c=a},this.addTransition=function(a,b,c){var e,f,h,i,j=/([A-Za-z_]\w*)/g;try{var f=ARCS.EventLogicParser.parse(b);if("string"==typeof f)void 0===d[a]&&(d[a]={}),d[a][f]=c,g(f);else{for(;null!==(e=j.exec(b));)g(e[0]);h=ARCS.TransitionSystem.build(f),i=h.clone(a+"_"+c+"_"),i.renameState(i.initial,a),i.renameState(i.final,c),i.visitTransitions(function(a,b,c){void 0===d[a]&&(d[a]={}),d[a][b]=c})}}catch(a){}},this.setToken=function(a){void 0!==d[e]&&void 0!==d[e][a]&&(e=d[e][a],this.emit("requestSheet",e),e===c&&this.emit("requestTermination"))},this.setTransitions=function(a){var b,c;for(b in a)if(a.hasOwnProperty(b))for(c in a[b])a[b].hasOwnProperty(c)&&this.addTransition(b,c,a[b][c])},this.start=function(){e=b,this.emit("requestSheet",e)},void 0!==a&&(b=a.initial,c=a.final,this.setTransitions(a.transitions),e="")},["setToken"],["requestSheet","requestTermination"]),ARCS.Application=function(){var a,b=new ARCS.Context,c={},d={},e=[],f=this,g="";this.export=function(){var a={context:b,controller:b.getComponentName(d),sheets:c};return a},this.getContext=function(){return b},this.getSheetList=function(){return Object.keys(c)},this.getSheet=function(a){return c[a]},this.addSheet=function(a,d){c[a]=d,d.setContext(b)},this.removeSheet=function(a){delete c[a]},a=function(){var a,e,g;for(e=b.getComponent(d),d=e,g=Object.keys(c),a=0;a<g.length;a++)e=new ARCS.Sheet(b),e.import(c[g[a]],b),c[g[a]]=e;ARCS.Component.connect(d,"requestSheet",f,"setSheet"),ARCS.Component.connect(d,"requestTermination",f,"finish"),d.start()},this.setController=function(a){d=b.getComponent(a)},this.setSheet=function(a){c.hasOwnProperty(a)?(g&&c[g].deactivate(),g=a,c[g].activate()):console.warn("[ARCS] Tried to activate hollow sheet named: "+a)},this.finish=function(){g&&c[g].deactivate()},this.import=function(a){b=new ARCS.Context(a.context),c=a.sheets,d=a.controller,void 0===d&&console.error("[ARCS] Undefined controller. Cannot start application.")},this.setFactory=function(a,b){factories[a]=b},this.setDependency=function(a){e[a]={}},this.start=function(){console.log("[ARCS] Starting application"),b.instanciate().then(a)}},ARCS.Application.setDependency=function(a,b){a.setDependency(b)},ARCS.Component.create(ARCS.Application),ARCS.Application.slot("setSheet"),ARCS.Application.slot("finish"),arcs_module=function(a,b){var c,d;"undefined"!=typeof module&&module.parent.exports&&(ARCS=module.exports),void 0===b&&(b=[]),c=function(b){var c,d;if(b.unshift(ARCS),c="function"==typeof a?a.apply(this,b):a,void 0===c)throw new Error("[ARCS] Your module is undefined. Did you forget to export components?\nCode of module follows:\n"+a);for(d in c)c.hasOwnProperty(d)&&null!=ARCS.Context.currentContext&&ARCS.Context.currentContext.setFactory(d,c[d])};var e=function(a){return new Promise(function(b,c){var d,e;ARCS.isInNode()?(d=require(a),void 0===d?c(a):b(d)):(void 0!==a.name&&(e={shim:{}},e.shim[a.name]={exports:a.exports},void 0!==a.deps&&(e.shim[a.name].deps=a.deps),require.config(e),a=a.name),require([a],function(a){b(a)},function(b){console.log("[ARCS] Trouble with module ",a),c(a,b)}))})},f=[];for(d=0;d<b.length;d++)f[d]=e(b[d]);ARCS.Context.currentContext.addLibraryPromise(Promise.all(f).then(c,function(a){console.error("[ARCS] Failed to load dependency "+a)}))},!ARCS.isInNode())var exports={};exports.Component=ARCS.Component,exports.Connection=ARCS.Connection,exports.Invocation=ARCS.Invocation,exports.Statemachine=ARCS.Statemachine,exports.Sheet=ARCS.Sheet,exports.Application=ARCS.Application,exports.EventLogicParser=ARCS.EventLogicParser,exports.TransitionSystem=ARCS.TransitionSystem,exports.isInNode=ARCS.isInNode,exports.isInRequire=ARCS.isInRequire,ARCS.isInRequire()&&define(exports);